# Node

ETH-ECC 노드는 월드랜드 네트워크에 연결되어 월드랜드 네트워크의 최신 상태를 따라잡기 위해 동기화합니다. 서로 다른 메커니즘을 사용하여 체인의 헤드까지 동기화하는 두 가지 유형의 노드 방식과 두 가지 유형의 동기화 방식이 존재합니다.



We outline both types of full nodes and guides for getting them up and running. For a detailed description of the node, please refer to the following[ **link**](https://geth.ethereum.org/docs/fundamentals/sync-modes).



### 요약 <a href="#summary" id="summary"></a>

Geth 노드를 동기화하는 방법에는 여러 가지가 있습니다. 기본값은 스냅 동기화를 사용하여 전체 노드를 만드는 것입니다. 전체 노드는 제네시스에서 블록별로 동기화(full-sync)하거나 중간 체크포인트 블록에서 시작(snap-sync)하여 생성할 수 있습니다. 기본적으로 이러한 모드는 128개 블록보다 오래된 상태 데이터를 정리하여 요청 시 과거 상태를 재생성할 수 있는 체크포인트만 유지합니다. 기록 데이터의 빠른 쿼리를 위해서는 아카이브 노드가 필요합니다. 아카이브 노드는 모든 기록 데이터의 로컬 사본을 제네시스(현재 약 12TB 및 성장 중)로 되돌려 보관합니다. 부분 아카이브 노드는 노드를 스냅 동기화하고 초기 동기화 블록 이후의 모든 상태를 유지하는 노드를 생성하기 위해 상태 가지치기를 꺼서 생성할 수 있습니다. 현재 지분 증명으로의 전환으로 인해 라이트 동기화가 작동하지 않습니다(새로운 라이트 클라이언트 프로토콜이 개발 중임).



### 전체 노드 <a href="#full-nodes" id="full-nodes"></a>

서로 다른 메커니즘을 사용하여 체인의 헤드까지 동기화하는 두 가지 유형의 전체 노드가 있습니다.

#### 스냅(기본값) <a href="#snap-sync" id="snap-sync"></a>

스냅 동기화는 비교적 최근 블록에서 시작하여 거기에서 체인의 헤드까지 동기화하여 가장 최근의 128개 블록 상태만 메모리에 유지합니다. 동기화할 블록 헤더는 합의 클라이언트에서 제공합니다. 초기 동기화 블록과 가장 최근의 128개 블록 사이에서 노드는 중간 상태를 "즉시" 재구축하는 데 사용할 수 있는 간헐적인 스냅샷을 저장합니다. 스냅 동기화 노드와 전체 블록별 동기화 노드의 차이점은 스냅 동기화 노드는 제네시스 블록보다 더 최근인 초기 체크포인트에서 시작된다는 것입니다. 스냅 동기화는 제네시스의 전체 블록별 동기화보다 훨씬 빠릅니다. 스냅 동기화로 노드를 시작하려면 시작 시 --syncmode snap을 전달합니다 .

<figure><img src="https://geth.ethereum.org/images/docs/state-pruning.png" alt=""><figcaption></figcaption></figure>

스냅 동기화는 블록 청크에 대한 헤더를 먼저 다운로드하여 작동합니다. 헤더가 확인되면 해당 블록의 블록 본문과 영수증이 다운로드됩니다. 동시에 Geth도 상태 동기화를 시작합니다. 상태 동기화에서 Geth는 먼저 범위 증명과 함께 중간 노드 없이 각 블록에 대한 상태 트리의 리프를 다운로드합니다. 그러면 상태 트리가 로컬에서 재생성됩니다.

상태 다운로드는 완료하는 데 가장 많은 시간이 걸리는 스냅 동기화의 일부이며 로그 메시지의 ETA 값을 사용하여 진행 상황을 모니터링할 수 있습니다. 그러나 블록체인도 동시에 진행되고 있으며 재생성된 상태 데이터 중 일부를 무효화하고 있습니다. 이는 상태의 오류가 수정되는 '치유' 단계도 필요함을 의미합니다. 현재 상태가 이미 재생성될 때까지 오류의 범위를 알 수 없기 때문에 상태 치유의 진행 상황을 모니터링할 수 없습니다. Geth는 정기적으로 동기화, 상태 치유 중 상태 치유 진행 중을 보고합니다 . 이는 상태 치유가 완료되지 않았음을 사용자에게 알립니다. eth.syncing을 사용하여 이를 확인할 수도 있습니다 . 이 명령이 false를 반환하는 경우그러면 노드가 동기화됩니다. false 이외의 값을 반환하면 동기화가 아직 진행 중인 것입니다.

치유는 블록체인의 성장을 능가해야 합니다. 그렇지 않으면 노드가 현재 상태를 따라잡지 못할 것입니다. 상태 복구 속도(디스크 읽기/쓰기 속도 및 인터넷 연결 속도)와 각 블록에서 사용되는 총 가스를 결정하는 몇 가지 하드웨어 요소가 있습니다(가스가 더 많다는 것은 처리해야 하는 상태에 대한 더 많은 변경 사항을 의미함).

요약하면 스냅 동기화는 다음 순서로 진행됩니다.

* 헤더 다운로드 및 확인
* 블록 본문 및 영수증을 다운로드합니다. 동시에 원시 상태 데이터를 다운로드하고 상태 트리를 빌드합니다.
* 새로 도착하는 데이터를 설명하기 위한 치료 상태 시도

**메모**

스냅 동기화는 기본 동작이므로 시작할 때 --syncmode 값이 Geth에 전달되지 않으면 Geth는 스냅 동기화를 사용합니다. 스냅을 사용하여 시작된 노드는 체인의 헤드를 따라잡으면 블록별 동기화로 전환됩니다.

#### 가득한 <a href="#full-sync" id="full-sync"></a>

전체 블록별 동기화는 제네시스 블록에서 시작하여 모든 블록을 실행하여 현재 상태를 생성합니다. 전체 동기화는 블록의 전체 기록 시퀀스에서 트랜잭션을 다시 실행하여 블록 출처와 모든 상태 전환을 독립적으로 확인합니다. 가장 최근의 128개 블록 상태만 전체 노드에 저장됩니다. 오래된 블록 상태는 주기적으로 가지치기되며 요청 시 이전 상태를 재생성할 수 있는 일련의 체크포인트로 표시됩니다. 128 블록은 블록 시간이 12초인 약 25.6분의 기록입니다.

전체 노드를 생성하려면 시작 시 --syncmode full을 전달합니다 .



### 아카이브 노드 <a href="#archive-nodes" id="archive-nodes"></a>

아카이브 노드는 모든 과거 데이터를 제네시스로 다시 유지하는 노드입니다. 모든 데이터는 노드 자체 스토리지에서 직접 사용할 수 있으므로 체크포인트에서 데이터를 재생성할 필요가 없습니다. 따라서 아카이브 노드는 기록 상태에 대한 빠른 쿼리를 만드는 데 이상적입니다. 작성 당시(2022년 9월) 제네시스 이후 모든 데이터를 저장하는 전체 아카이브 노드는 거의 12TB의 디스크 공간을 차지합니다( [Etherscan](https://etherscan.io/chartsync/chainarchive) 의 현재 크기 유지 ). 보관 노드는 오래된 데이터가 절대 삭제되지 않도록 Geth의 가비지 수집을 구성하여 생성됩니다( geth --syncmode full --gcmode archive ) .

노드가 스냅을 사용하여 동기화되었지만 상태가 정리되지 않은 부분/최근 아카이브 노드를 생성하는 것도 가능합니다 . 이렇게 하면 노드가 처음 동기화되는 시점부터 모든 상태 데이터를 저장하는 아카이브 노드가 생성됩니다. 이것은 --syncmode snap --gcmode archive 로 Geth를 시작하여 구성됩니다 .





| Full Node | Archive Node |
| --------- | ------------ |
|           |              |
|           |              |
|           |              |

### Sync Mode

| Full Sync | Snap Sync |
| --------- | --------- |
|           |           |
|           |           |
|           |           |





### &#x20;<a href="#summary" id="summary"></a>
